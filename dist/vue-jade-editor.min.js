/**
 * vue-jade-editor
 * @version v0.3.0 - 2016-05-23
 * @link http://html5beta.com/apps/vue-jade-editor.html
 * @author ZHAO Xudong (zxdong@gmail.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(t,e,n){var i={"default":{indent:"    ",template:'<div class="jade-editor"><textarea rows="{{rows}}" class="{{cls}}" @keyup="keyup($event)" @keydown="keydown($event)" @click="syncSelection()" @change="syncSelection()">{{content}}</textarea></div>',data:function(){return{_textarea:!1,nSelStart:0,nSelEnd:0,cls:"form-control"}},methods:{keyup:function(t){var e=t.keyCode,n=i.keycodes.keyup[e];return n?void this["handleKeyEvt_"+n](t,this.updateSyntax):this.updateSyntax()},keydown:function(t){var e=t.keyCode,n=i.keycodes.keydown[e];n&&this["handleKeyEvt_"+n](t,this.updateSyntax)},getTextArea:function(){return this._textarea?this._textarea:(this._textarea=this.$el.children[0],this._textarea)},syncSelection:function(){var t=this.getTextArea();t.selectionStart;this.nSelStart=t.selectionStart,this.nSelEnd=t.selectionEnd},updateSyntax:function(){var t=this.getTextArea();this.content=t.value,this.syncSelection(),this.autoGrow()},autoGrow:function(){var t=this.getTextArea();t.scrollHeight>t.clientHeight&&(t.style.height=t.scrollHeight+10+"px")},handleKeyEvt_tab:function(t,e){t.preventDefault();var n=this,a=this.getTextArea(),s=i["default"].indent,r=a.selectionStart,l=a.selectionEnd,o=a.value,c=o.substring(r,l),u=o.substring(r-1,r);"\n"!==u&&""!==u?a.value=o.substring(0,r)+s+o.substring(l):(c=s+c.replace(/\n/g,"\n"+s),a.value=o.substring(0,r)+c+o.substring(l),a.selectionStart=r===l?r+s.length:r,a.selectionEnd=r===l?r+s.length:r+c.length),e.call(n)},handleKeyEvt_enter:function(t,e){var n=this,a=i["default"].indent,s=this.getTextArea(),r=s.selectionStart,l=s.selectionEnd,o=s.value,c=o.substring(0,r).split("\n"),u=c.length,d=c[u-2],h=/^( *)/,g=d.match(h),v=g[1];s.value=o.substring(0,r)+v+a+o.substring(l),s.selectionStart=r+v.length+a.length,s.selectionEnd=s.selectionStart,e.call(n)},handleKeyEvt_backspace:function(t,e){var n=this,a=i["default"].indent,s=a.length,r=this.getTextArea(),l=r.selectionStart,o=r.selectionEnd,c=r.value,u=c.substring(0,l),d=u.split("\n"),h=d.length,g=d[h-1],v=/^ *$/.test(g),f=l-g.length,y=c.substring(f,l),p=y.length;!v||s>p||(t.preventDefault(),r.value=c.substring(0,f)+y.replace(a,"")+c.substring(o),e.call(n))},handleKeyEvt_open_bracket:function(t,e){var n=this,a=i["default"].indent,s=this.getTextArea(),r=s.selectionStart,l=s.selectionEnd,o=s.value,c=o.substring(r,l),u=t.shiftKey?"{":"[",d=t.shiftKey?"}":"]";if(t.preventDefault(),!t.ctrlKey)return n.insertParedContent(u,d,e);var h=!c.length;if(h){var g=o.substring(0,r).split("\n"),v=g.length;c=g[v-1];var f=r-c.length,y=o.substring(0,f)}for(var p=c.split("\n"),b=p.length,S=[],E=new RegExp("^"+a),x=0;b>x;x++)S.push(p[x].replace(E,""));c=S.join("\n"),h?(s.value=y+c+o.substring(l),s.selectionStart=y.length,s.selectionEnd=y.length):(s.value=o.substring(0,r)+c+o.substring(l),s.selectionStart=r,s.selectionEnd=r+(r===l?0:c.length+1)),e.call(n)},handleKeyEvt_close_bracket:function(t,e){return t.ctrlKey?this.handleKeyEvt_tab(t,e):void 0},insertParedTag:function(t,e){var n=this,i=this.getTextArea(),a=i.selectionStart,s=i.selectionEnd,r=i.value,l=t.length+2,o=2*l+1;i.value=r.substring(0,a)+"<"+t+">"+r.substring(a,s)+"</"+t+">"+r.substring(s),i.selectionStart=a===s?a+l:a,i.selectionEnd=s+(a===s?l:o),e.call(n)},insertParedContent:function(t,e,n){var i=this,a=this.getTextArea(),s=a.selectionStart,r=a.selectionEnd,l=a.value,o=t.length,c=o+e.length;a.value=l.substring(0,s)+t+l.substring(s,r)+e+l.substring(r),a.selectionStart=s===r?s+o:s,a.selectionEnd=r+(s===r?o:c),n.call(i)},handleKeyEvt_single_quote:function(t,e){var n=this,i=this.getTextArea(),a=(i.selectionStart,i.selectionEnd,i.value,t.shiftKey?'"':"'");t.preventDefault(),n.insertParedContent(a,a,e)},handleKeyEvt_left_bracket:function(t,e){var n=this,i=this.getTextArea();i.selectionStart,i.selectionEnd,i.value;return t.shiftKey?(t.preventDefault(),void n.insertParedContent("(",")",e)):e.call(n)},handleKeyEvt_i:function(t,e){var n=this,i=this.getTextArea();i.selectionStart,i.selectionEnd,i.value;return t.ctrlKey?(t.preventDefault(),void n.insertParedTag("i",e)):e.call(n)},handleKeyEvt_b:function(t,e){var n=this,i=this.getTextArea();i.selectionStart,i.selectionEnd,i.value;return t.ctrlKey?(t.preventDefault(),void n.insertParedTag("b",e)):e.call(n)}},events:{"je-insert-content":function(t,e,n){if(e===this.id){var i=this.getTextArea(),a=this.nSelStart,s=this.nSelEnd,r=i.value;i.value=r.substring(0,a)+t+r.substring(s),i.selectionStart=n?a:s+t.length,i.selectionEnd=s+t.length,this.updateSyntax()}},"je-tab":function(t){t===this.id&&this.handleKeyEvt_tab({preventDefault:function(){}},this.updateSyntax)},"je-untab":function(t){t===this.id&&this.handleKeyEvt_open_bracket({preventDefault:function(){},ctrlKey:!0},this.updateSyntax)},"je-paired-tag":function(t,e){e===this.id&&this.insertParedTag(t,this.updateSyntax)},"je-paired-content":function(t,e,n){n===this.id&&this.insertParedContent(t,e,this.updateSyntax)}}},keycodes:{keyup:{13:"enter",73:"i",66:"b"},keydown:{9:"tab",8:"backspace",222:"single_quote",57:"left_bracket",219:"open_bracket",221:"close_bracket"}}};i.base=function(){return{template:i["default"].template,props:{content:String,rows:Number,id:String},data:i["default"].data,events:i["default"].events,methods:i["default"].methods}},i.install=function(t){t.component("jadeeditor",i.base())},"object"==typeof exports?module.exports=i:"function"==typeof define&&define.amd?define([],function(){return i}):t.Vue&&(t.jadeEditor=i)}(window,document);